module optimize

strategies

  optimize-sdf = alltd(optimize)
  
  // Convert literal rhs to char group (e.g., "{" -> [\125])
  optimize:
    prod(pattern, lit(s), attrs) ->
    prod(
      pattern
    , char-class(simple-charclass(present(numeric(chargroup))))
    , attrs
    )
    where
      <explode-string> s => ['"', char, '"']
    with
      chargroup := <conc-strings> ("\\", <write-to-string> char)