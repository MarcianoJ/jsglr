<project>

	<condition property="binary.sdf2table" value="${project.loc}/tests-offside/tools/win/sdf2table.exe" else="${project.loc}/tests-offside/tools/mac/sdf2table">
			<os family="windows" />
		</condition>

	<target name="compile">
		<compile-grammar module="UnicodeSDF" />
	</target>
	
	<macrodef name="compile-grammar">
		<attribute name="module" />
		<attribute name="path" default="." />
		<sequential>
			<sdf2table source="@{path}/@{module}.def" output="@{path}/@{module}.tbl" module="SDF" />
		</sequential>
	</macrodef>

	<macrodef name="sdf2table">
		<attribute name="source" />
		<attribute name="output" />
		<attribute name="module" />
		<attribute name="failonerror" default="true" />
		<sequential>
			<exec executable="${binary.sdf2table}" failonerror="@{failonerror}">
				<arg value="-i" />
				<arg value="@{source}" />
				<arg value="-o" />
				<arg value="@{output}" />
				<arg value="-m" />
				<arg value="@{module}" />
			</exec>
		</sequential>
	</macrodef>

</project>